<?xml version="1.0" encoding="UTF-8"?>
<!--
  Copyright 2011-2016 Hippo B.V. (http://www.onehippo.com)

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
  -->
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <parent>
    <artifactId>hippo-addon-channel-manager</artifactId>
    <groupId>org.onehippo.cms7</groupId>
    <version>4.0.0-cmng-psp1-SNAPSHOT</version>
  </parent>


  <artifactId>hippo-addon-channel-manager-frontend</artifactId>
  <packaging>jar</packaging>

  <name>Addon Channel Manager Frontend</name>

  <properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <channel.manager.package>${project.build.directory}/classes/org/onehippo/cms7/channelmanager</channel.manager.package>
    <channel.editor.package>${channel.manager.package}/channeleditor</channel.editor.package>
  </properties>

  <dependencies>
    <dependency>
      <groupId>org.apache.cxf</groupId>
      <artifactId>cxf-rt-rs-client</artifactId>
    </dependency>

    <dependency>
      <groupId>com.fasterxml.jackson.core</groupId>
      <artifactId>jackson-databind</artifactId>
    </dependency>

    <dependency>
      <groupId>org.onehippo.cms7</groupId>
      <artifactId>hippo-addon-channel-manager-frontend-api</artifactId>
      <version>${project.version}</version>
    </dependency>

    <dependency>
      <groupId>org.onehippo.cms7</groupId>
      <artifactId>hippo-cms7-commons</artifactId>
      <scope>provided</scope>
    </dependency>

    <dependency>
      <groupId>org.onehippo.cms7.hst.dependencies</groupId>
      <artifactId>hst-cms-dependencies</artifactId>
      <version>${hippo.hst.version}</version>
      <type>pom</type>
      <scope>provided</scope>
    </dependency>

    <dependency>
      <groupId>org.onehippo.cms7</groupId>
      <artifactId>hippo-cms-api</artifactId>
      <version>${hippo.cms.version}</version>
      <scope>provided</scope>
    </dependency>

    <dependency>
      <groupId>org.json</groupId>
      <artifactId>json</artifactId>
      <version>${lib.json.version}</version>
    </dependency>

    <dependency>
      <groupId>org.onehippo.cms7</groupId>
      <artifactId>hippo-cms-jquery</artifactId>
      <version>${hippo.cms.version}</version>
      <scope>provided</scope>
    </dependency>

    <dependency>
      <groupId>org.onehippo.cms7</groupId>
      <artifactId>hippo-repository-connector</artifactId>
      <version>${hippo.repository.version}</version>
      <scope>provided</scope>
    </dependency>

    <dependency>
      <groupId>org.onehippo.cms7</groupId>
      <artifactId>hippo-cms-editor-frontend</artifactId>
      <version>${hippo.cms.version}</version>
      <scope>provided</scope>
    </dependency>

    <dependency>
      <groupId>org.onehippo.cms7</groupId>
      <artifactId>hippo-cms-gallery-frontend</artifactId>
      <version>${hippo.cms.version}</version>
      <scope>provided</scope>
    </dependency>

    <dependency>
      <groupId>org.onehippo.cms7</groupId>
      <artifactId>hippo-repository-api</artifactId>
      <version>${hippo.repository.version}</version>
      <scope>provided</scope>
    </dependency>

    <dependency>
      <groupId>org.onehippo.cms7</groupId>
      <artifactId>hippo-repository-builtin</artifactId>
      <version>${hippo.repository.version}</version>
      <scope>provided</scope>
    </dependency>

    <dependency>
      <groupId>org.onehippo.cms7</groupId>
      <artifactId>hippo-addon-hst-configuration-editor-frontend</artifactId>
    </dependency>

    <dependency>
      <groupId>commons-lang</groupId>
      <artifactId>commons-lang</artifactId>
      <version>${commons-lang.version}</version>
      <scope>provided</scope>
    </dependency>

    <dependency>
      <groupId>org.onehippo.cms7.frontend</groupId>
      <artifactId>hippo-theme</artifactId>
      <version>${hippo.frontend.theme.version}</version>
      <classifier>distribution</classifier>
      <type>zip</type>
      <scope>provided</scope>
    </dependency>

    <dependency>
      <groupId>org.onehippo.cms7</groupId>
      <artifactId>hippo-addon-channel-manager-angularjs-api</artifactId>
      <version>${project.version}</version>
      <classifier>distribution</classifier>
      <type>zip</type>
      <scope>provided</scope>
    </dependency>

    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
    </dependency>

    <dependency>
      <groupId>org.easymock</groupId>
      <artifactId>easymock</artifactId>
    </dependency>

  </dependencies>
  <build>
    <defaultGoal>package</defaultGoal>
    <resources>
      <resource>
        <filtering>false</filtering>
        <directory>${basedir}/src/main/java</directory>
        <includes>
          <include>**/*.html</include>
        </includes>
      </resource>
      <resource>
        <filtering>false</filtering>
        <directory>${basedir}/src/main/resources</directory>
        <includes>
          <include>**/*</include>
        </includes>
      </resource>
    </resources>
    <plugins>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>jslint-maven-plugin</artifactId>
        <configuration>
          <assumeConsoleAlertEtc>true</assumeConsoleAlertEtc>
          <disallowInsecureCharsInRegExp>false</disallowInsecureCharsInRegExp>
          <predefinedVars>
            ActiveXObject,
            Class,
            Ext,
            G_vmlCanvasManager,
            Hippo,
            HST,
            jQuery,
            SVGAnimatedString,
            XPathResult,
            YAHOO,
            window
          </predefinedVars>
          <sourceJsFolder>${basedir}/src/main/resources</sourceJsFolder>
          <tolerateEval>true</tolerateEval>
        </configuration>
      </plugin>
      <plugin>
        <groupId>net.alchim31.maven</groupId>
        <artifactId>yuicompressor-maven-plugin</artifactId>
        <configuration>
          <aggregations>
            <aggregation>
              <insertNewLine>true</insertNewLine>
              <includes>
                <include>${channel.manager.package}/common/MarkRequiredFields.js</include>
                <include>${channel.manager.package}/ExtStoreFuture.js</include>
                <include>${channel.manager.package}/BreadcrumbToolbar.js</include>
                <include>${channel.manager.package}/Pinger.js</include>
                <include>${channel.manager.package}/RootPanel.js</include>
                <include>${channel.manager.package}/BlueprintListPanel.js</include>
                <include>${channel.manager.package}/ChannelFormPanel.js</include>
                <include>${channel.manager.package}/channels/ChannelOverview.js</include>
                <include>${channel.manager.package}/channels/ChannelPropertiesWindow.js</include>
                <include>${channel.manager.package}/channels/ChannelGridPanel.js</include>
                <include>${channel.manager.package}/channels/ChannelIconPanel.js</include>
              </includes>
              <output>${channel.manager.package}/channel-manager-bundle.js</output>
            </aggregation>
            <aggregation>
              <insertNewLine>true</insertNewLine>
              <includes>
                <include>${channel.manager.package}/common/MarkRequiredFields.js</include>
                <include>${channel.editor.package}/plugins/colorfield/colorfield.js</include>
                <include>${channel.editor.package}/plugins/floatingwindow/FloatingWindow.js</include>
                <include>${channel.editor.package}/plugins/vtabs/VerticalTabPanel.js</include>
                <include>${channel.editor.package}/ComponentVariants.js</include>
                <include>${channel.editor.package}/ComponentPropertiesForm.js</include>
                <include>${channel.editor.package}/ComponentPropertiesPanel.js</include>
                <include>${channel.editor.package}/ComponentPropertiesWindow.js</include>
                <include>${channel.editor.package}/ChannelEditor.js</include>
              </includes>
              <output>${channel.editor.package}/channel-editor-bundle.js</output>
            </aggregation>
          </aggregations>
        </configuration>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-surefire-plugin</artifactId>
        <configuration>
          <forkMode>always</forkMode>
          <workingDirectory>${project.build.directory}</workingDirectory>
        </configuration>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-dependency-plugin</artifactId>
        <version>${maven.plugin.dependency.version}</version>
        <executions>
          <execution>
            <id>fetch-bower-dependencies</id>
            <phase>initialize</phase>
            <goals>
              <goal>copy-dependencies</goal>
            </goals>
            <configuration>
              <includeGroupIds>org.onehippo.cms7, frontend,org.onehippo.cms7</includeGroupIds>
              <includeArtifactIds>
                hippo-theme, hippo-addon-channel-manager-angularjs-api
              </includeArtifactIds>
              <stripClassifier>true</stripClassifier>
              <stripVersion>true</stripVersion>
            </configuration>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>exec-maven-plugin</artifactId>
        <version>${maven.plugin.exec.version}</version>
        <executions>
          <execution>
            <id>npm-install</id>
            <phase>generate-sources</phase>
            <goals>
              <goal>exec</goal>
            </goals>
            <configuration>
              <executable>npm</executable>
              <commandlineArgs>install</commandlineArgs>
            </configuration>
          </execution>
          <execution>
            <id>bower-install</id>
            <phase>process-resources</phase>
            <goals>
              <goal>exec</goal>
            </goals>
            <configuration>
              <executable>bower</executable>
              <commandlineArgs>install ${commandline.offline} --no-color</commandlineArgs>
            </configuration>
          </execution>
          <execution>
            <id>grunt-build</id>
            <phase>process-resources</phase>
            <goals>
              <goal>exec</goal>
            </goals>
            <configuration>
              <executable>grunt</executable>
              <commandlineArgs>build --no-color</commandlineArgs>
            </configuration>
          </execution>
          <execution>
            <id>grunt-test</id>
            <phase>test</phase>
            <goals>
              <goal>exec</goal>
            </goals>
            <configuration>
              <executable>grunt</executable>
              <commandlineArgs>test --no-color</commandlineArgs>
              <skip>${skipTests}</skip>
            </configuration>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>

</project>
